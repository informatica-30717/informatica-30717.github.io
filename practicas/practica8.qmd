---
title: "Pr√°ctica 8: BIM sem√°ntico "
format:
  html: 
    toc: true
    number-sections: true
  revealjs: 
    output-ext: "reveal.html"
execute:
  echo: false
---

## Objetivos de la pr√°ctica

- Conocer la representaci√≥n de modelos BIM usando ontolog√≠as
- Hacer consultas al modelo BIM usando un razonador sem√°ntico.

## ¬øQu√© es BIM?
El **Modelado de Informaci√≥n de Construcci√≥n** (**BIM** en ingl√©s) es un proceso colaborativo para gestionar la informaci√≥n en un proyecto de construcci√≥n (Ver @fig-BIM).

![Youtube [Autodesk Building Solutions What Is BIM (Building Information Modeling)?](https://www.youtube.com/watch?v=suNadRnHy-Un).](../resources/practica8/bim1.png){#fig-BIM}

BIM se basa en la representaci√≥n digital de un edificio para integrar el dise√±o, el modelado, la planificaci√≥n y la operaci√≥n durante todo su **ciclo de vida**, desde el dise√±o hasta el demolici√≥n (Ver @fig-edif).
Los modelos BIM incluyen numerosos datos interconectados, como un modelo geom√©trico 3D de los elementos del edificio, una descripci√≥n de los materiales utilizados y sus propiedades, etc. Las **ventajas** de usar BIM incluyen la optimizaci√≥n de los costes de construcci√≥n y mantenimiento, la mejora de la transparencia y la colaboraci√≥n entre las diferentes partes interesadas, la gesti√≥n de proyectos complejos y la flexibilidad para adaptarse r√°pidamente a los requisitos cambiantes. Por lo tanto, BIM es un elemento clave en la **digitalizaci√≥n** del **sector de la construcci√≥n**.

![ Ciclo de vida de la edificaci√≥n.](../resources/practica8/bim2.png){#fig-edif}


## Uso de un software visualizador BIM
En esta pr√°ctica considerararemos diferentes versiones de un modelo BIM p√∫blicamente
disponible correspondiente a un apartamento d√∫plex. La versi√≥n original ([‚¨áÔ∏è Duplex.ifc](../resources/practica8/Duplex.ifc)) est√° en IFC (concretamente, 2x3). La versi√≥n sem√°ntica ([‚¨áÔ∏è Duplex.owl](../resources/practica8/Duplex.owl)) est√° en el **lenguaje OWL**. 

El primer paso de la pr√°ctica es usar [BIMvision](https://bimvision.eu) u otro visualizador BIM para abrir el fichero **Duplex.ifc** y familiarizarse con el modelo. La @fig-visor muestra el
detalle de una ventana de la planta baja (Level 1). 

![ Modelo Duplex en BIMvision.](../resources/practica8/fig1.png){#fig-visor}

::: {.callout-note}
## üß† Ejercicio 1 - Encontrar elementos
¬øCu√°ntas ventanas hay? 

¬øQu√© identificador, alturas y anchura tiene cada una?
:::


##  Conversi√≥n a modelo sem√°ntico
Este apartado es opcional, puesto que el objetivo es obtener el fichero Duplex.owl que ya
est√° disponible, pero en todo caso vamos a describir mejor el proceso seguido
para obtener el fichero. Aunque existen varias herramientas que permiten traducir un fichero
de entrada en IFC a un fichero de salida en OWL, en nuestro caso se ha usado en particular
[IFCtoLBD 2.43.5](https://github.com/jyrkioraskari/IFCtoLBD/releases/tag/2.43.5). Debemos tener cuenta que este fichero utiliza vocabulario (clases y propiedades) previamente definidas en ontolog√≠as existentes en el √°mbito de la construcci√≥n. 

::: {.callout-warning}
Se ha usado la configuraci√≥n **BOT + PRODUCT + PROPS, Level L1**. Manualmente, se ha
eliminado la referencia a 2 ontolog√≠as externas (OMG y MEP) para simplificar la pr√°ctica.
:::

## Uso del editor de ontolog√≠as Prot√©g√© 

Para abrir el fichero **Duplex.owl** usaremos [Prot√©g√©](http://protege.stanford.edu), un editor
de ontolog√≠as gratuito y con versiones para varios sistemas operativos,. Prot√©g√© no requiere
instalaci√≥n, basta descargar un fichero .zip, descomprimirlo y pinchar en el ejecutable.

En el men√∫ de opciones que hay bajo el t√≠tulo de la ontolog√≠a (‚ÄúConverters‚Äù), podemos elegir
**Entities** para seleccionar los diferentes componentes de la ontolog√≠a (ver @fig-protege cuadro en color rojo): clases (**Classes**),
propiedades cuyo valor es un objeto/individuo (**Object properties**), propiedades cuyo valor
es un tipo de dato conocido por la m√°quina (**Data properties**), individuos (**Individuals**), etc.

La @fig-protege muestra el resultado de seleccionar **Clases** y, concretamente, **Edificio**.
Obs√©rvese c√≥mo la interfaz nos muestra que **Edificio** es una subclase de **Zona**. 

![Jerarqu√≠a de clases y detalle de la clase ‚ÄúEdificio‚Äù.](../resources/practica8/fig2.png){#fig-protege}

![V√≠deo tutorial: editor Prot√©g√© [The Coding Train](https://drive.google.com/file/d/1eHHxYrJRiQZni_7KKrtRFqu5KEwk9omW/view).]

Dependiendo de la versi√≥n de la herramienta Prot√©g√© utilizada, es posible que importe
autom√°ticamente las ontolog√≠as desde Internet o que nos pida que aportemos ficheros
locales para importar las ontolog√≠as. En este √∫ltimo caso, en **Active ontology ‚Üí Ontology
imports** pinchamos en el bot√≥n **+** para a√±adir los ficheros
[‚¨áÔ∏è beo.owl](../resources/practica8/beo.owl) y [‚¨áÔ∏è bot.owl](../resources/practica8/bot.owl).

Como vemos en la @fig-protege, algunos elementos de la ontolog√≠a tienen asociadas varias
anotaciones con etiquetas en m√∫ltiples idiomas. Por ejemplo, la clase
**http://w3id.org/bot/Building** tiene etiquetas **Building**, **Edificio**, etc. Dependiendo de la
configuraci√≥n de nuestro ordenador (del idioma predeterminado), Prot√©g√© puede mostrarnos
las etiquetas en un idioma u otro. En este guion, se asume que se muestran en castellano. 


::: {.callout-note}
## üß† Ejercicio 2 - Encontrar elementos
Navegar a trav√©s de la jerarqu√≠a de **clases** de la ontolog√≠a y localizar la que permite
representar las ventanas.

Navegar a trav√©s de la jerarqu√≠a de **propiedades** de la ontolog√≠a y localizar las que
permiten representar la altura de una ventana y la anchura de una ventana.

Navegar a trav√©s de los **individuos** de la ontolog√≠a, localizar una ventana y comprobar el
valor de sus propiedades. ¬øSe corresponden con lo mostrado por OpenIFCViewer?

<details>
<summary>üí° Soluci√≥n Classes</summary>
![ Visualizar Clases.](../resources/practica8/classes.png){#fig-clas}
</details>


<details>
<summary>üí° Soluci√≥n Propiedades</summary>
![ Visualizar Object properties.](../resources/practica8/property1.png){#fig-prop1}

![ Visualizar Data properties.](../resources/practica8/property2.png){#fig-prop2}
</details>

<details>
<summary>üí° Soluci√≥n Individuos</summary>
![ Visualizar Individuos.](../resources/practica8/individuals.png){#fig-ind}
</details>
:::

::: {.callout-note}
## üß† Ejercicio 3 - Inferencia y consultar
Para cargar un **razonador**, pinchamos en la opci√≥n del men√∫ superior **Reasoner**. Seg√∫n la
versi√≥n de Prot√©g√©, puede haber uno o varios razonadores. Seleccionamos **HermiT** y
pinchamos en **Start reasoner**. Si hacemos cambios en la ontolog√≠a, tendremos que pinchar
en **Synchronize reasoner**.

Posteriormente, a trav√©s de la pesta√±a **DL query**, podemos hacer consultas al razonador.
Recuperar las instancias de la clase que representa las **ventanas** (en ingl√©s). Pinchando en alguna
de ellas, podemos ver los valores de las propiedades (tanto los originales como los inferidos
por el razonador, si los hubiera).

Recuperar las superclases de la clase que representa las ventanas.

Recuperar las instancias de alguna de las superclases obtenidas en el paso anterior, para comprobar que el razonador recupera las instancias indirectas.

Recuperar nuevamente las instancias de la clase que representa las **ventanas**. Da click sobre el simbolo **?** en alguna instancia. El rasonador te dara al menos una explicaci√≥n.

<details>
<summary>üí° Ejemplo: Escalera</summary>
![ Visualizar consulta DL.](../resources/practica8/stairs_example_DL.png){#fig-str1}
![ Visualizar Explicaci√≥n.](../resources/practica8/stair_explanation.png){#fig-str2}
</details>

:::

::: {.callout-note}
## üß† Ejercicio 3 - Consultas
Para hacerlo a√∫n m√°s interesante, Prot√©g√© permite construir consultas complejas que involucran a varios elementos a la vez. 

Recuperar las instancias de ‚Äú**Espacio and 'elemento adyacente' some Window**‚Äù, que es el conjunto de espacios que tienen un elemento tal adyacente que pertenece a la clase Ventana. 
¬øCu√°ntos individuos hay?

:::

::: {.callout-note}
## üß† Ejercicio 4 - Ontolog√≠a incosistente
Si la ontolog√≠a es **inconsistente**, no se puede razonar con ella: el razonador avisa de ello y permite pinchar en el bot√≥n **Explain** para entender el motivo y poder resolverlo.

Actualizar la ontolog√≠a introduciendo una inconsistencia. Por ejemplo, a√±adiendo dos
valores diferentes para la altura de una ventana. Primero, marcamos la propiedad como
**Functional**. A continuaci√≥n, buscamos la ventana y a√±adimos una **Data property
assertions** con el bot√≥n **+**, eligiendo la propiedad que representa la altura y un valor
diferente al que ya ten√≠a (como 1234). Por √∫ltimo, debemos sincronizar el razonador. 

<details>
<summary>üí° Soluci√≥n Funcional</summary>
![ Propiedad funcional.](../resources/practica8/functional_property.png){#fig-fnl}

![ A√±adir propiedad y valor](../resources/practica8/property_value.png){#fig-val}


![Explicar](../resources/practica8/explain.png){#fig-exp1}

![Explicaci√≥n](../resources/practica8/explanation.png){#fig-exp2}


</details>
:::
