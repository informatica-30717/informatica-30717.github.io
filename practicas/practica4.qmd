---
title: "PrÃ¡ctica 4: Aspectos avanzados de Excel"
format:
  html: 
    toc: true
    number-sections: true
  revealjs: 
    output-ext: "reveal.html"
execute:
  echo: false
---


::: {.card .shadow-sm .mb-4 .mt-4}
::: {.card-body}

```{ojs}
viewof params = {
  const cleanSlider = (range, config) => {
    const input = Inputs.range(range, config);
    const numberBox = input.querySelector("input[type=number]");
    if (numberBox) numberBox.style.display = "none";
    const rangeSlider = input.querySelector("input[type=range]");
    if (rangeSlider) rangeSlider.style.width = "100%";
    input.style.width = "100%";
    return input;
  };

  const ia = cleanSlider([0.1, 5], { value: 1, step: 0.1 });

  const col = (input, label) => {
    const val = htl.html`<div style="font-family: monospace; color: #555; margin-top: 4px;">${input.value.toFixed(1)}</div>`;
    input.addEventListener("input", () => val.textContent = input.value.toFixed(1));
    
    return htl.html`<div style="display: flex; flex-direction: column; align-items: center; margin: 0 10px; flex: 1; min-width: 120px;">
      <div style="font-weight: bold; font-size: 0.9rem; margin-bottom: 5px; white-space: nowrap;">${label}</div>
      <div style="width: 100%">${input}</div>
      ${val}
    </div>`;
  };

  const form = htl.html`<div style="display: flex; flex-wrap: wrap; justify-content: center; width: 50%; padding-bottom: 20px; border-bottom: 1px solid #eee; margin: 0 auto 20px auto;">
    ${col(ia, "Constante a")}
  </div>`;

  form.oninput = () => form.value = { a: ia.value };
  form.value = { a: ia.value };
  return form;
}
```

```{ojs}
// Extracted to its own block for proper reactivity
a = params.a
```

```{ojs}
{
  const curve = Array.from({ length: 401 }, (_, i) => {
    const x = -10 + i * 0.05;
    
    // THE FIX: Clamp the max y-value to 20 so it gracefully goes off-screen 
    // without crashing the SVG `<path>` renderer.
    const y = Math.min(20, a * Math.cosh(x / a));
    
    return { x, y };
  });

  const points = [];
  
  if (a !== 0) {
    points.push({ 
      x: 0, 
      y: a, 
      type: "Vertex", 
      label: `V=(0, ${a.toFixed(2)})` 
    });
  }

  const curve_plot = Plot.plot({
    height: 400,
    grid: true,
    marginLeft: 40, 
    marginRight: 20,
    x: { domain: [-4, 4], label: "x axis" },
    y: { domain: [-0, 6], label: "y axis" }, 
    marks: [
      Plot.ruleY([0], { stroke: "#888", strokeWidth: 1.5 }),
      Plot.ruleX([0], { stroke: "#888", strokeWidth: 1.5 }),
      Plot.line(curve, { x: "x", y: "y", stroke: "steelblue", strokeWidth: 3 }),
      Plot.dot(points, { 
        x: "x", 
        y: "y", 
        fill: "#f4a261", 
        r: 6, 
        stroke: "white", 
        strokeWidth: 2 
      }),
      Plot.text(points, { 
        x: "x", 
        y: "y", 
        text: "label", 
        dy: -15, 
        fill: "currentColor", 
        stroke: "white", 
        strokeWidth: 4, 
        fontWeight: "bold", 
        fontSize: 12 
      })
    ]
  });
  
  curve_plot.style.width = "100%";
  return curve_plot;
}
```
:::
:::